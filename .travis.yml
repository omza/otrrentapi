sudo: required
language: python
python: '3.6'
services:
- docker
script:
- docker build --build-arg FLASK_DEPLOY_MODULE=otrrentapi --build-arg FLASK_DEPLOY_CALLABLE=app
  --build-arg FLASK_DEPLOY_PORT=8001 --build-arg FLASK_DEPLOY_DOMAIN=otrrent.app-workshop.de
  -t otrrent/otrrentapi ./otrrentapi
after_success:
- docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"
- docker push otrrent/otrrentapi
before_deploy:
- openssl aes-256-cbc -K $encrypted_6e0ef56981eb_key -iv $encrypted_6e0ef56981eb_iv
  -in azurevm_rsa.enc -out azurevm_rsa -d
- eval "$(ssh-agent -s)"
- chmod 600 azurevm_rsa
- ssh-add azurevm_rsa
deploy:
- provider: script
  skip_cleanup: true
  script: ssh -o StrictHostKeyChecking=no "$PROD_USERNAME"@"$PROD_HOST" "$PROD_DEPLOYCMD"
env:
  global:
  - secure: o6Px0f7RwhJ+bez/hqYivZfq6m7Ykc04BEmLRQlWplf7gIPDgZJDiSdZun8+9MDljRL944oyy2heGsXVz8jdT9D7WD35uNvde8/i6tppRNYBzGRGLQmUdO+yxXfeSwDdKH5PAo7QX0JF5fJ/jsPfa0yPL+n42mwi9Pi9IX20FcPcY7iV0uzSI5QkhHzADIlg0bs2WEAra25QqxwVCi1Sknuf/ymHK4K4YUp9Y3LsoRBI/coVOedwk4Z+77LE+sJF2zKauyCoa+4fjun6XpFWGmHgG0RzFXJ1xVJhpzpatb98YPADlvrBY6gLqRdo0vuZ7inpdDHXLVgEg+EmwpgwZsEtURxXDVwIGRllN6jVLvMhnytsOOOz9hkqeujschvS2tAL4gtXiylwWFf9bD3BqAIu/yFk5fM+xt2rsZc4h6yc1DUl/VZaBCDv/N4A21kFPljj1QSR0KKdszsKNFj84sf8zUmfyzd0ycwZ4U8qbjewiZjbQranl4BBrHjKpySmmG2Zzr7QzVjgU5vlXLmowF0nwmYf8rnepxHH5oWxypaIKj36b+TiQMT+B1JIkA6LU3DY8CxtR16BUUMQ/8AW8hzs/Ii7zplGylWnsfN8UG+Nm44RfIw7aYLUuF+bzYwdez/jz4cmyH0kT2JdbVzJtoskOxC4Y4jWsu5d+P9eLvY=
  - secure: I6znCPElyk/qhwRtYVtd943YSf4+QBF3MNsbXBjftJcQUEU49pOtu8lAl6Z0xA/rKV9d3Adnj0Q/k0QNPg+Y4la8TaeHgBEFgVMKmVG0CWmxNmK3tx/1i1MJqj/tK7NztHWdeATVegi8LQPQH1TSV0ZviymAhFaYx0xbmJntksiTNqcbpSYKYo5xx0yXcChQvu/IaeO3XQanKPsHn8S2s97bJ6ljYmbfWdK4Rj3QVjX91QFsTDyDyImHosmqvR3rO9STjBtJbBSRATXzXF+3s2ORzLzJ66jJKWYebofhpUgtoDuZaxK5zGp741bv3brtioLr1VZfGQjEPe4abCAKnA/GROuiwDv+W1YllbxK9yclI6uNpzmW82+Q81xVFX8h6QAAYdmc6xBCeU56WR11woyAgFFbAuWbtgBn3C5Xeha6ZLUikuYMv7maeTz9Mu9xk3NgxLENoMMGVwybZ4DJuFPDmNr5rQUPq3RsUFXauHaIJccJJx62UOny5db16pKG84wrlTdKMAh13IY7DvTk1ZqKTa97cRtJAmY+HQLCNr5jqlSdCHiX6ssv4uz82xNSnypsDpRAR7JhuwABXibOfJOqYJKslSBEzxxmUI0s8XByvH4oc79Urm/nix6fZcrOj+mMRTaDgyFMSsZgW3IkYS1UC+Ff5GDQtBNxwDvI18A=
  - secure: RahBL/VadLtL+UQFgsNdjDxAIxTx5/BBiEz+PPYGS2KgSt7XEiWJD0Z19voTBrCOAncf2QSIRPi0pOf6xuXZxLkY24TUNK2BiZ/u5Cu6n6VRPvAH04vzg0Uz1FqT2YSIl/xt/ylSkEzTAmMJOTFWIzXUZchjZcGRJjFZn0RwIz4l+ML6FwVY35TzkQgLlUqxtvs3BDYbPSWGUpw8r1CKFNCIKAT4bZNQdf3c0t5sU2/WXv+pVoF0ByMi149Lr/iB9OqfsAnb09Qa+fqjm8fhHtJjLr34v255AZo2k/OljQx+UWG+ZqerQkIj72GjpzMdraw6GOXQuqKTLawa910lgJfL0ei2fbgz277M5CpGsJ2sbTCUXXtSsloeQKulnSzsvhm4PFYTF+63XD+EYOLmq1wGsOmUiU3XUbrVHkENxMQwDTgyutigDYsOj4Xokl4J9clV01tyxkG6ze3VsY6fqzZ1nHIXr3MyiC3+Y9PWkQAAs/fJVCpgkXjvEMkgAA6rmiBWEGEg5URZhJaw50WFua3z6HoM9eg1XtkVoFtY+tdtK6JYWdjMq0neyVoIJkzqJEKPg55AHwHXZMrTH5ucqhHjfMOW1E4IIx7nHZdkoG7vzjDaVuCNJvlCORvZdXN8R2SGivtAgo3LPx+jtW6orgWBVNDvsaXILtmphq8xpfU=
  - secure: mY+1K/Lm4MAq4Ek49MRFzuIm51rdVyK+zaNOMRl9d6iUS6ntY51Ag148gl5ExaxZfz9q0fFvbhKbBSzGtoGiUG7o2z8oS1eWq7FFt99sAifYfk4jZR2rv2ZHL5I02RBCSpIptoG0XhNcXA5VndfpKcR+uL2Mq/jL96BoqYu7YD+2Kvjt3c/p580cz2MFYAd9NZ0tsNxr9bGlVajFx0XOYxNCCVEjiVoHHSMqBHtg6OUhV+h4y4EUe67tMr1RDdTi4amP/eRxCrXaoaLyzq168u7/AWusOAAAKzKmM0/1slRveeEF5Nqg7VlQKKy5xycoyPdYcb/FnnXUachMu+CG5egbrCDI50va1Rbq0wZQsOHwENdrV1yrcSg2xqWz1LGaoqp9Mdimj9xaWZF9TfQ4a+ER+gsfRUuxDqf+NSDuGVzXQUANzOgGFZUVJqLp4dinK2iGZGEfzUgP3+72BCmBeYF6IkYysg32iZm0jBjCFdd+y+m5YsJ/JRyUGl7NkZijPdS7u5SbUIEjXpc7cKaevjHh8F6ZodnapWrK/0l+f2N2yUotIzWdSTHHrrOMcJnerkkgZsUB3tyBzYm2ebvwSCesG8nJJA5Prr+Tywe5tQWCwr8zrWjT9JuVL35ZVF5Rgneq3s//EUtAwawcR+8jc+bBFdqjmRJjgVtdcMP3B10=
  - secure: kKDInc1shqclWYPBiJ9V4tBBeZM9B5HzjyMMm8U7HOeSh81hx/jWSkX6VQhOZR4Bq/pV0iYXgvCKVOH+8l820AEnRBYlNCGkWtqsE6NYx6CHfkFndRH3wY4kkkqwY+7AJ6YqUkEQV3Wz927B0RG3EkWqb/u5yfmAqiBajKlfiWOEMS1jvXgFg/Mzcc3xnPxFV60Uwi1ZnGNZGEaBxVG9rRai2A7VItX7x/qnAe3MksAH9F2IgcA366QpSvQvsoEHy36gyuLxd4A7Rc+mxIXGusYsQyNMh9ES27+aNPbVEvGtnWL2h7nEz+FG9Yu4APP5VUwmmfSuvW18jZfve7BwJxFd3r/da4SXRp3N0ITQsoB+SbqyPRioZWXEFEslgv0MJn1etjmHK58vHKUtRMQxPDiAIpziXsz1uf3e1gdc2LCB827qUTdwyULI/R71YTqUXcCHrJJ0Pj8ki+WJZcb62Gog3q+f5q2V9WRCUMjoeJfV6FX1/AO8sySSPNimTYHxSxKFguIX2lPtkzRjo0VUJuj8Xpem1j30yC29BPYHP1uCE1YKQMDxf9TDg6iFKePZzJ452CP6KrXEUQuOXCFuDO/T5a4xq+57kScOcP7jjYen8ioASqEkDbtiwf89QVGvS4X6cLDhSqwskudy+BX5aGuFxPwO26nF2+WNrpuhhHs=
notifications:
  slack:
    secure: az7XH949ltjgc24D/+cp9HJ1NCi2w33d2rNumdtiixIXNsBlYd/cSRbyI57AZFwL2Zd/+zzcteV9uEHUuEtVejeVa9qZzkAqevwINYIuxnlLZbjERKGG1AHt1jR8yb5cMFa5YBj1M/nwXmfnYr/0d1QJ8rpJyYdjlbtOSiElMbtS2sW7Jl91148z/vhOPXByztYVdzxUeA5k8S4msJ3pnEod/88tj0v9HvHWo/XKIY7973/eSsen1+nh6lNq3BaWfrtHwsVBBeVsB7/22TPeVFPNe41AfYo49c9LcrPH4Cs+q8omnrEP6piys+3dugcvnj9pyTdzqrvLuyDWVYdm7Q6YNtSyqRGUBgHJK4y3UEWYnJLBbKCbosiNGYHVQJ8Xfdei8ijOSCWq1Itx6DryUCC687kpAqIBRjM5rFuIgXXGPb8F246zOZz5kFpQpcmnsPhLibQia8WSp1FL7OmapaKDAEr1/QdO3lSRLdizlmZR2OsveNLMhdIeoQ64qOzoeGrakc4DubKzwftC6ntrsuzxAJwL27+5d3LByMZ8lz9Io3cbBzyIgrYkVKbWVHMPFW+wVDScVI3acQSZ0NWV7TCDX6QNxV6DLfrZY9vVjPCEGwgujel2bdaQ+AAPdPanac2Az6TgFzKuC+6xFO4QuksF3SzItm7p8CPQoktYAoo=
